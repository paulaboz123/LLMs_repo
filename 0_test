# 1) Pobierz endpoint
ep = ml_client.online_endpoints.get(ENDPOINT_NAME)
print("Current traffic:", ep.traffic)

# 2) Ustaw traffic na inny deployment (np. 100% na new-deploy)
ep.traffic = {DEPLOYMENT_TARGET: 100}
poller = ml_client.online_endpoints.begin_create_or_update(ep)
poller.result()
print("Updated traffic:", ml_client.online_endpoints.get(ENDPOINT_NAME).traffic)

# 3) Dopiero teraz usu≈Ñ stary deployment
del_poller = ml_client.online_deployments.begin_delete(
    name=DEPLOYMENT_TO_REMOVE,
    endpoint_name=ENDPOINT_NAME,
)
del_poller.result()
print("Deleted:", DEPLOYMENT_TO_REMOVE)
